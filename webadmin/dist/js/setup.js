"use strict";var app=angular.module("Application",["ngRoute","ngAnimate","angular-md5"]);app.directive("ngEnter",function(){return function(e,t,n){t.bind("keydown keypress",function(t){13===t.which&&e.$apply(function(){e.$eval(n.ngEnter)})})}}),app.config(["$routeProvider",function(e){e.when("/",{redirectTo:"/step1"}).when("/step1",{controller:"StepController",templateUrl:"views/setup/step1.html"}).when("/step2",{controller:"StepController",templateUrl:"views/setup/step2.html"}).when("/step3",{controller:"StepController",templateUrl:"views/setup/step3.html"}).when("/step4",{controller:"StepController",templateUrl:"views/setup/step4.html"}).when("/step5",{controller:"FinishController",templateUrl:"views/setup/step5.html"}).otherwise({redirectTo:"/"})}]),app.service("Wizard",[function(){function e(){this.username="",this.email="",this.password=""}var t=null;return t=new e}]),app.controller("StepController",["$scope","$location","Wizard",function(e,t,n){e.wizard=n,e.ok=function(e,n){n||t.path(e)},e.$on("$viewContentLoaded",function(){$("input[autofocus]").focus()})}]),app.controller("FinishController",["$scope","$location","$timeout","Wizard","Client",function(e,t,n,o,r){function i(){r.createAdmin(e.wizard.username,e.wizard.password,e.wizard.email,e.setupToken,function(e){return e?(console.error("Internal error",e),void(window.location.href="/error.html")):void(window.location.href="/")})}e.wizard=o,n(i,1e3)}]),app.controller("SetupController",["$scope","$location","Client","Wizard",function(e,t,n,o){e.initialized=!1;var r=decodeURIComponent(window.location.search).slice(1).split("&").map(function(e){return e.split("=")}).reduce(function(e,t){return e[t[0]]=t[1],e},{});e.setupToken=r.setupToken,o.email=r.email,n.isServerFirstTime(function(n,r){return n?void(window.location.href="/error.html"):r?(o.username||t.path("/step1"),void(e.initialized=!0)):void(window.location.href="/")})}]),angular.module("Application").service("Client",["$http","md5",function(e,t){function n(e,t){Error.call(this),this.name=this.constructor.name,this.statusCode=e,this.message="string"==typeof t?t:JSON.stringify(t)}function o(e){return function(t,o){return 401===o?i.logout():void e(new n(o,t))}}function r(){this._ready=!1,this._configListener=[],this._readyListener=[],this._userInfo={username:null,email:null,admin:!1},this._token=null,this._clientId="cid-webadmin",this._clientSecret="unused",this._config={apiServerOrigin:null,webServerOrigin:null,fqdn:null,ip:null,revision:null,update:{box:null,apps:null},isDev:!1,progress:{},isCustomDomain:!1},this._installedApps=[],this.setToken(localStorage.token)}var i=null;return r.prototype.setReady=function(){this._ready||(this._ready=!0,this._readyListener.forEach(function(e){e()}))},r.prototype.onReady=function(e){this._ready&&e(),this._readyListener.push(e)},r.prototype.onConfig=function(e){this._configListener.push(e),e(this._config)},r.prototype.setUserInfo=function(e){this._userInfo.username=e.username,this._userInfo.email=e.email,this._userInfo.admin=!!e.admin,this._userInfo.gravatar="https://www.gravatar.com/avatar/"+t.createHash(e.email.toLowerCase())+".jpg?s=24&d=mm",this._userInfo.gravatarHuge="https://www.gravatar.com/avatar/"+t.createHash(e.email.toLowerCase())+".jpg?s=128&d=mm"},r.prototype.setConfig=function(e){this._config.apiServerOrigin=e.apiServerOrigin,this._config.webServerOrigin=e.webServerOrigin,this._config.version=e.version,this._config.fqdn=e.fqdn,this._config.ip=e.ip,this._config.revision=e.revision,this._config.update=e.update,this._config.isDev=e.isDev,this._config.progress=e.progress,this._config.isCustomDomain=e.isCustomDomain;var t=this;this._configListener.forEach(function(e){e(t._config)})},r.prototype.getInstalledApps=function(){return this._installedApps},r.prototype.getUserInfo=function(){return this._userInfo},r.prototype.getConfig=function(){return this._config},r.prototype.setToken=function(t){e.defaults.headers.common.Authorization="Bearer "+t,t?localStorage.token=t:localStorage.removeItem("token"),this._token=t},r.prototype.config=function(t){e.get("/api/v1/cloudron/config").success(function(e,o){return 200!==o||"object"!=typeof e?t(new n(o,e)):void t(null,e)}).error(o(t))},r.prototype.userInfo=function(t){e.get("/api/v1/profile").success(function(e,o){return 200!==o||"object"!=typeof e?t(new n(o,e)):void t(null,e)}).error(o(t))},r.prototype.installApp=function(t,r,i,s,p,u){var a=this,c={appStoreId:t,manifest:r,password:i,location:p.location,portBindings:p.portBindings,accessRestriction:p.accessRestriction};e.post("/api/v1/apps/install",c).success(function(e,t){return 202!==t||"object"!=typeof e?u(new n(t,e)):(e.manifest={title:s},a._installedApps.push(e),void u(null,e.id))}).error(o(u))},r.prototype.uninstallApp=function(t,r,i){var s={password:r};e.post("/api/v1/apps/"+t+"/uninstall",s).success(function(e,t){return 202!==t?i(new n(t,e)):void i(null)}).error(o(i))},r.prototype.configureApp=function(t,r,i,s){var p={appId:t,password:r,location:i.location,portBindings:i.portBindings,accessRestriction:i.accessRestriction};e.post("/api/v1/apps/"+t+"/configure",p).success(function(e,t){return 202!==t?s(new n(t,e)):void s(null)}).error(o(s))},r.prototype.updateApp=function(t,r,i,s){e.post("/api/v1/apps/"+t+"/update",{manifest:r,password:i}).success(function(e,t){return 202!==t?s(new n(t,e)):void s(null)}).error(o(s))},r.prototype.startApp=function(t,r){var i={};e.post("/api/v1/apps/"+t+"/start",i).success(function(e,t){return 202!==t?r(new n(t,e)):void r(null)}).error(o(r))},r.prototype.stopApp=function(t,r){var i={};e.post("/api/v1/apps/"+t+"/stop",i).success(function(e,t){return 202!==t?r(new n(t,e)):void r(null)}).error(o(r))},r.prototype.version=function(t){e.get("/api/v1/cloudron/status").success(function(e,o){return 200!==o||"object"!=typeof e?t(new n(o,e)):void t(null,e)}).error(o(t))},r.prototype.isServerFirstTime=function(t){e.get("/api/v1/cloudron/status").success(function(e,o){return 200!==o||"object"!=typeof e?t(new n(o,e)):void t(null,!e.activated)}).error(o(t))},r.prototype.getNakedDomain=function(t){e.get("/api/v1/settings/naked_domain").success(function(e,o){return 200!==o||"object"!=typeof e?t(new n(o,e)):void t(null,e.appid)}).error(o(t))},r.prototype.setNakedDomain=function(t,r){e.post("/api/v1/settings/naked_domain",{appid:t}).success(function(e,t){return 204!==t?r(new n(t)):void r(null)}).error(o(r))},r.prototype.getApps=function(t){e.get("/api/v1/apps").success(function(e,o){return 200!==o||"object"!=typeof e?t(new n(o,e)):void t(null,e.apps)}).error(o(t))},r.prototype.getApp=function(e,t){var n=null;return this._installedApps.some(function(t){return t.id===e?(n=t,!0):!1}),n?t(null,n):t(new Error("App not found"))},r.prototype.getAppLogStream=function(e){var t=new EventSource("/api/v1/apps/"+e+"/logstream");return t},r.prototype.getAppLogUrl=function(e){return"/api/v1/apps/"+e+"/logs?access_token="+this._token},r.prototype.setAdmin=function(t,r,i){var s={username:t,admin:r};e.post("/api/v1/users/"+t+"/admin",s).success(function(e,t){return 204!==t?i(new n(t,e)):void i(null)}).error(o(i))},r.prototype.createAdmin=function(t,r,i,s,p){var u={username:t,password:r,email:i},a=this;e.post("/api/v1/cloudron/activate?setupToken="+s,u).success(function(e,o){return 201!==o||"object"!=typeof e?p(new n(o,e)):(a.setToken(e.token),a.setUserInfo({username:t,email:i,admin:!0}),void p(null,e.activated))}).error(o(p))},r.prototype.listUsers=function(t){e.get("/api/v1/users").success(function(e,o){return 200!==o||"object"!=typeof e?t(new n(o,e)):void t(null,e)}).error(o(t))},r.prototype.getOAuthClients=function(t){e.get("/api/v1/oauth/clients").success(function(e,o){return 200!==o||"object"!=typeof e?t(new n(o,e)):void t(null,e.clients)}).error(o(t))},r.prototype.delTokensByClientId=function(t,r){e["delete"]("/api/v1/oauth/clients/"+t+"/tokens").success(function(e,t){return 204!==t?r(new n(t,e)):void r(null)}).error(o(r))},r.prototype.update=function(t,r){e.post("/api/v1/cloudron/update",{password:t}).success(function(e,t){return 202!==t||"object"!=typeof e?r(new n(t,e)):void r(null,e)}).error(o(r))},r.prototype.reboot=function(t){e.get("/api/v1/cloudron/reboot").success(function(e,o){return 202!==o||"object"!=typeof e?t(new n(o,e)):void t(null,e)}).error(o(t))},r.prototype.backup=function(t){e.post("/api/v1/cloudron/backups").success(function(e,o){return 202!==o||"object"!=typeof e?t(new n(o,e)):void t(null,e)}).error(o(t))},r.prototype.setCertificate=function(t,r,i){console.log("will set certificate");var s=new FormData;s.append("certificate",t),s.append("key",r),e.post("/api/v1/cloudron/certificate",s,{headers:{"Content-Type":void 0},transformRequest:angular.identity}).success(function(e,t){return 202!==t?i(new n(t,e)):void i(null)}).error(o(i))},r.prototype.graphs=function(t,r,i){var s={params:{target:t,format:"json",from:r}};e.get("/api/v1/cloudron/graphs",s).success(function(e,t){return 200!==t||"object"!=typeof e?i(new n(t,e)):void i(null,e)}).error(o(i))},r.prototype.createUser=function(t,r,i){var s={username:t,email:r};e.post("/api/v1/users",s).success(function(e,t){return 201!==t||"object"!=typeof e?i(new n(t,e)):void i(null,e)}).error(o(i))},r.prototype.removeUser=function(t,r,i){var s={username:t,password:r};e({method:"DELETE",url:"/api/v1/users/"+t,data:s,headers:{"Content-Type":"application/json"}}).success(function(e,t){return 204!==t?i(new n(t,e)):void i(null)}).error(o(i))},r.prototype.changePassword=function(t,r,i){var s={password:t,newPassword:r};e.post("/api/v1/users/"+this._userInfo.username+"/password",s).success(function(e,t){return 204!==t?i(new n(t,e)):void i(null,e)}).error(o(i))},r.prototype.changeEmail=function(t,r,i){var s={password:r,email:t};e.put("/api/v1/users/"+this._userInfo.username,s).success(function(e,t){return 204!==t?i(new n(t,e)):void i(null,e)}).error(o(i))},r.prototype.refreshConfig=function(e){var t=this;e="function"==typeof e?e:function(){},this.config(function(n,o){return n?e(n):(t.setConfig(o),void e(null))})},r.prototype.refreshInstalledApps=function(e){var t=this;e="function"==typeof e?e:function(){},this.getApps(function(n,o){if(n)return e(n);o.forEach(function(e){for(var n=!1,o=0;o<t._installedApps.length;++o)if(t._installedApps[o].id===e.id){n=o;break}n!==!1?angular.copy(e,t._installedApps[n]):t._installedApps.push(e)});for(var r=t._installedApps.length-1;r>=0;--r)o.some(function(e){return e.id===t._installedApps[r].id})||t._installedApps.splice(r,1);e(null)})},r.prototype.logout=function(){this.setToken(null),this._userInfo={},window.location.href="/api/v1/session/logout"},r.prototype.exchangeCodeForToken=function(t,r){var i={grant_type:"authorization_code",code:t,redirect_uri:window.location.origin,client_id:this._clientId,client_secret:this._clientSecret};e.post("/api/v1/oauth/token?response_type=token&client_id="+this._clientId,i).success(function(e,t){return 200!==t||"object"!=typeof e?r(new n(t,e)):void r(null,e.access_token)}).error(o(r))},i=new r}]);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNldHVwLmpzIiwiY2xpZW50LmpzIl0sIm5hbWVzIjpbImFwcCIsImFuZ3VsYXIiLCJtb2R1bGUiLCJkaXJlY3RpdmUiLCJzY29wZSIsImVsZW1lbnQiLCJhdHRycyIsImJpbmQiLCJldmVudCIsIndoaWNoIiwiJGFwcGx5IiwiJGV2YWwiLCJuZ0VudGVyIiwiY29uZmlnIiwiJHJvdXRlUHJvdmlkZXIiLCJ3aGVuIiwicmVkaXJlY3RUbyIsImNvbnRyb2xsZXIiLCJ0ZW1wbGF0ZVVybCIsIm90aGVyd2lzZSIsInNlcnZpY2UiLCJXaXphcmQiLCJ0aGlzIiwidXNlcm5hbWUiLCJlbWFpbCIsInBhc3N3b3JkIiwiaW5zdGFuY2UiLCIkc2NvcGUiLCIkbG9jYXRpb24iLCJ3aXphcmQiLCJvayIsInBhZ2UiLCJiYWQiLCJwYXRoIiwiJG9uIiwiJCIsImZvY3VzIiwiJHRpbWVvdXQiLCJDbGllbnQiLCJmaW5pc2giLCJjcmVhdGVBZG1pbiIsInNldHVwVG9rZW4iLCJlcnJvciIsImNvbnNvbGUiLCJ3aW5kb3ciLCJsb2NhdGlvbiIsImhyZWYiLCJpbml0aWFsaXplZCIsInNlYXJjaCIsImRlY29kZVVSSUNvbXBvbmVudCIsInNsaWNlIiwic3BsaXQiLCJtYXAiLCJpdGVtIiwicmVkdWNlIiwibyIsImsiLCJpc1NlcnZlckZpcnN0VGltZSIsImlzRmlyc3RUaW1lIiwiJGh0dHAiLCJtZDUiLCJDbGllbnRFcnJvciIsInN0YXR1c0NvZGUiLCJtZXNzYWdlIiwiRXJyb3IiLCJjYWxsIiwibmFtZSIsImNvbnN0cnVjdG9yIiwiSlNPTiIsInN0cmluZ2lmeSIsImRlZmF1bHRFcnJvckhhbmRsZXIiLCJjYWxsYmFjayIsImRhdGEiLCJzdGF0dXMiLCJjbGllbnQiLCJsb2dvdXQiLCJfcmVhZHkiLCJfY29uZmlnTGlzdGVuZXIiLCJfcmVhZHlMaXN0ZW5lciIsIl91c2VySW5mbyIsImFkbWluIiwiX3Rva2VuIiwiX2NsaWVudElkIiwiX2NsaWVudFNlY3JldCIsIl9jb25maWciLCJhcGlTZXJ2ZXJPcmlnaW4iLCJ3ZWJTZXJ2ZXJPcmlnaW4iLCJmcWRuIiwiaXAiLCJyZXZpc2lvbiIsInVwZGF0ZSIsImJveCIsImFwcHMiLCJpc0RldiIsInByb2dyZXNzIiwiaXNDdXN0b21Eb21haW4iLCJfaW5zdGFsbGVkQXBwcyIsInNldFRva2VuIiwibG9jYWxTdG9yYWdlIiwidG9rZW4iLCJwcm90b3R5cGUiLCJzZXRSZWFkeSIsImZvckVhY2giLCJvblJlYWR5IiwicHVzaCIsIm9uQ29uZmlnIiwic2V0VXNlckluZm8iLCJ1c2VySW5mbyIsImdyYXZhdGFyIiwiY3JlYXRlSGFzaCIsInRvTG93ZXJDYXNlIiwiZ3JhdmF0YXJIdWdlIiwic2V0Q29uZmlnIiwidmVyc2lvbiIsInRoYXQiLCJnZXRJbnN0YWxsZWRBcHBzIiwiZ2V0VXNlckluZm8iLCJnZXRDb25maWciLCJkZWZhdWx0cyIsImhlYWRlcnMiLCJjb21tb24iLCJBdXRob3JpemF0aW9uIiwicmVtb3ZlSXRlbSIsImdldCIsInN1Y2Nlc3MiLCJpbnN0YWxsQXBwIiwiaWQiLCJtYW5pZmVzdCIsInRpdGxlIiwiYXBwU3RvcmVJZCIsInBvcnRCaW5kaW5ncyIsImFjY2Vzc1Jlc3RyaWN0aW9uIiwicG9zdCIsInVuaW5zdGFsbEFwcCIsImFwcElkIiwiY29uZmlndXJlQXBwIiwidXBkYXRlQXBwIiwic3RhcnRBcHAiLCJzdG9wQXBwIiwiYWN0aXZhdGVkIiwiZ2V0TmFrZWREb21haW4iLCJhcHBpZCIsInNldE5ha2VkRG9tYWluIiwiZ2V0QXBwcyIsImdldEFwcCIsImFwcEZvdW5kIiwic29tZSIsImdldEFwcExvZ1N0cmVhbSIsInNvdXJjZSIsIkV2ZW50U291cmNlIiwiZ2V0QXBwTG9nVXJsIiwic2V0QWRtaW4iLCJwYXlsb2FkIiwibGlzdFVzZXJzIiwiZ2V0T0F1dGhDbGllbnRzIiwiY2xpZW50cyIsImRlbFRva2Vuc0J5Q2xpZW50SWQiLCJyZWJvb3QiLCJiYWNrdXAiLCJzZXRDZXJ0aWZpY2F0ZSIsImNlcnRpZmljYXRlRmlsZSIsImtleUZpbGUiLCJsb2ciLCJmZCIsIkZvcm1EYXRhIiwiYXBwZW5kIiwiQ29udGVudC1UeXBlIiwidW5kZWZpbmVkIiwidHJhbnNmb3JtUmVxdWVzdCIsImlkZW50aXR5IiwiZ3JhcGhzIiwidGFyZ2V0cyIsImZyb20iLCJwYXJhbXMiLCJ0YXJnZXQiLCJmb3JtYXQiLCJjcmVhdGVVc2VyIiwicmVtb3ZlVXNlciIsIm1ldGhvZCIsInVybCIsImNoYW5nZVBhc3N3b3JkIiwiY3VycmVudFBhc3N3b3JkIiwibmV3UGFzc3dvcmQiLCJjaGFuZ2VFbWFpbCIsInB1dCIsInJlZnJlc2hDb25maWciLCJyZXN1bHQiLCJyZWZyZXNoSW5zdGFsbGVkQXBwcyIsImZvdW5kIiwiaSIsImxlbmd0aCIsImNvcHkiLCJlbGVtIiwic3BsaWNlIiwiZXhjaGFuZ2VDb2RlRm9yVG9rZW4iLCJhdXRoQ29kZSIsImdyYW50X3R5cGUiLCJjb2RlIiwicmVkaXJlY3RfdXJpIiwib3JpZ2luIiwiY2xpZW50X2lkIiwiY2xpZW50X3NlY3JldCIsImFjY2Vzc190b2tlbiJdLCJtYXBwaW5ncyI6IkFBQUEsWUFHQSxJQUFBQSxLQUFBQyxRQUFBQyxPQUFBLGVBQUEsVUFBQSxZQUFBLGVBRUFGLEtBQUFHLFVBQUEsVUFBQSxXQUNBLE1BQUEsVUFBQUMsRUFBQUMsRUFBQUMsR0FDQUQsRUFBQUUsS0FBQSxtQkFBQSxTQUFBQyxHQUNBLEtBQUFBLEVBQUFDLE9BQ0FMLEVBQUFNLE9BQUEsV0FDQU4sRUFBQU8sTUFBQUwsRUFBQU0sZ0JBUUFaLElBQUFhLFFBQUEsaUJBQUEsU0FBQUMsR0FDQUEsRUFBQUMsS0FBQSxLQUNBQyxXQUFBLFdBQ0FELEtBQUEsVUFDQUUsV0FBQSxpQkFDQUMsWUFBQSwyQkFDQUgsS0FBQSxVQUNBRSxXQUFBLGlCQUNBQyxZQUFBLDJCQUNBSCxLQUFBLFVBQ0FFLFdBQUEsaUJBQ0FDLFlBQUEsMkJBQ0FILEtBQUEsVUFDQUUsV0FBQSxpQkFDQUMsWUFBQSwyQkFDQUgsS0FBQSxVQUNBRSxXQUFBLG1C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T0FBQSxXQUNBckQsS0FBQTJFLFNBQUEsTUFDQTNFLEtBQUF5RCxhQUdBbkMsT0FBQUMsU0FBQUMsS0FBQSwwQkFHQVIsRUFBQThELFVBQUE4RixxQkFBQSxTQUFBQyxFQUFBNUgsR0FDQSxHQUFBQyxJQUNBNEgsV0FBQSxxQkFDQUMsS0FBQUYsRUFDQUcsYUFBQTFKLE9BQUFDLFNBQUEwSixPQUNBQyxVQUFBbEwsS0FBQTRELFVBQ0F1SCxjQUFBbkwsS0FBQTZELGNBR0F4QixHQUFBeUUsS0FBQSxxREFBQTlHLEtBQUE0RCxVQUFBVixHQUFBb0QsUUFBQSxTQUFBcEQsRUFBQUMsR0FDQSxNQUFBLE9BQUFBLEdBQUEsZ0JBQUFELEdBQUFELEVBQUEsR0FBQVYsR0FBQVksRUFBQUQsUUFFQUQsR0FBQSxLQUFBQyxFQUFBa0ksZ0JBQ0FoSyxNQUFBNEIsRUFBQUMsS0FHQUcsRUFBQSxHQUFBcEMiLCJmaWxlIjoic2V0dXAuanMiLCJzb3VyY2VzQ29udGVudCI6WyIndXNlIHN0cmljdCc7XG5cbi8vIGNyZWF0ZSBtYWluIGFwcGxpY2F0aW9uIG1vZHVsZVxudmFyIGFwcCA9IGFuZ3VsYXIubW9kdWxlKCdBcHBsaWNhdGlvbicsIFsnbmdSb3V0ZScsICduZ0FuaW1hdGUnLCAnYW5ndWxhci1tZDUnXSk7XG5cbmFwcC5kaXJlY3RpdmUoJ25nRW50ZXInLCBmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChzY29wZSwgZWxlbWVudCwgYXR0cnMpIHtcbiAgICAgICAgZWxlbWVudC5iaW5kKCdrZXlkb3duIGtleXByZXNzJywgZnVuY3Rpb24gKGV2ZW50KSB7XG4gICAgICAgICAgICBpZihldmVudC53aGljaCA9PT0gMTMpIHtcbiAgICAgICAgICAgICAgICBzY29wZS4kYXBwbHkoZnVuY3Rpb24gKCl7XG4gICAgICAgICAgICAgICAgICAgIHNjb3BlLiRldmFsKGF0dHJzLm5nRW50ZXIpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9O1xufSk7XG5cbi8vIHNldHVwIGFsbCBtYWpvciBhcHBsaWNhdGlvbiByb3V0ZXNcbmFwcC5jb25maWcoWyckcm91dGVQcm92aWRlcicsIGZ1bmN0aW9uICgkcm91dGVQcm92aWRlcikge1xuICAgICRyb3V0ZVByb3ZpZGVyLndoZW4oJy8nLCB7XG4gICAgICAgIHJlZGlyZWN0VG86ICcvc3RlcDEnXG4gICAgfSkud2hlbignL3N0ZXAxJywge1xuICAgICAgICBjb250cm9sbGVyOiAnU3RlcENvbnRyb2xsZXInLFxuICAgICAgICB0ZW1wbGF0ZVVybDogJ3ZpZXdzL3NldHVwL3N0ZXAxLmh0bWwnXG4gICAgfSkud2hlbignL3N0ZXAyJywge1xuICAgICAgICBjb250cm9sbGVyOiAnU3RlcENvbnRyb2xsZXInLFxuICAgICAgICB0ZW1wbGF0ZVVybDogJ3ZpZXdzL3NldHVwL3N0ZXAyLmh0bWwnXG4gICAgfSkud2hlbignL3N0ZXAzJywge1xuICAgICAgICBjb250cm9sbGVyOiAnU3RlcENvbnRyb2xsZXInLFxuICAgICAgICB0ZW1wbGF0ZVVybDogJ3ZpZXdzL3NldHVwL3N0ZXAzLmh0bWwnXG4gICAgfSkud2hlbignL3N0ZXA0Jywge1xuICAgICAgICBjb250cm9sbGVyOiAnU3RlcENvbnRyb2xsZXInLFxuICAgICAgICB0ZW1wbGF0ZVVybDogJ3ZpZXdzL3NldHVwL3N0ZXA0Lmh0bWwnXG4gICAgfSkud2hlbignL3N0ZXA1Jywge1xuICAgICAgICBjb250cm9sbGVyOiAnRmluaXNoQ29udHJvbGxlcicsXG4gICAgICAgIHRlbXBsYXRlVXJsOiAndmlld3Mvc2V0dXAvc3RlcDUuaHRtbCdcbiAgICB9KS5vdGhlcndpc2UoeyByZWRpcmVjdFRvOiAnLyd9KTtcbn1dKTtcblxuYXBwLnNlcnZpY2UoJ1dpemFyZCcsIFsgZnVuY3Rpb24gKCkge1xuICAgIHZhciBpbnN0YW5jZSA9IG51bGw7XG5cbiAgICBmdW5jdGlvbiBXaXphcmQoKSB7XG4gICAgICAgIHRoaXMudXNlcm5hbWUgPSAnJztcbiAgICAgICAgdGhpcy5lbWFpbCA9ICcnO1xuICAgICAgICB0aGlzLnBhc3N3b3JkID0gJyc7XG4gICAgfVxuXG4gICAgaW5zdGFuY2UgPSBuZXcgV2l6YXJkKCk7XG4gICAgcmV0dXJuIGluc3RhbmNlO1xufV0pO1xuXG5hcHAuY29udHJvbGxlcignU3RlcENvbnRyb2xsZXInLCBbJyRzY29wZScsICckbG9jYXRpb24nLCAnV2l6YXJkJywgZnVuY3Rpb24gKCRzY29wZSwgJGxvY2F0aW9uLCBXaXphcmQpIHtcbiAgICAkc2NvcGUud2l6YXJkID0gV2l6YXJkO1xuXG4gICAgJHNjb3BlLm9rID0gZnVuY3Rpb24gKHBhZ2UsIGJhZCkge1xuICAgICAgICBpZiAoIWJhZCkgJGxvY2F0aW9uLnBhdGgocGFnZSk7XG4gICAgfTtcblxuICAgICRzY29wZS4kb24oJyR2aWV3Q29udGVudExvYWRlZCcsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgJCgnaW5wdXRbYXV0b2ZvY3VzXScpLmZvY3VzKCk7XG4gICAgfSk7XG59XSk7XG5cbmFwcC5jb250cm9sbGVyKCdGaW5pc2hDb250cm9sbGVyJywgWyckc2NvcGUnLCAnJGxvY2F0aW9uJywgJyR0aW1lb3V0JywgJ1dpemFyZCcsICdDbGllbnQnLCBmdW5jdGlvbiAoJHNjb3BlLCAkbG9jYXRpb24sICR0aW1lb3V0LCBXaXphcmQsIENsaWVudCkge1xuICAgICRzY29wZS53aXphcmQgPSBXaXphcmQ7XG5cbiAgICBmdW5jdGlvbiBmaW5pc2goKSB7XG4gICAgICAgIENsaWVudC5jcmVhdGVBZG1pbigkc2NvcGUud2l6YXJkLnVzZXJuYW1lLCAkc2NvcGUud2l6YXJkLnBhc3N3b3JkLCAkc2NvcGUud2l6YXJkLmVtYWlsLCAkc2NvcGUuc2V0dXBUb2tlbiwgZnVuY3Rpb24gKGVycm9yKSB7XG4gICAgICAgICAgICBpZiAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKCdJbnRlcm5hbCBlcnJvcicsIGVycm9yKTtcbiAgICAgICAgICAgICAgICB3aW5kb3cubG9jYXRpb24uaHJlZiA9ICcvZXJyb3IuaHRtbCc7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB3aW5kb3cubG9jYXRpb24uaHJlZiA9ICcvJztcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgJHRpbWVvdXQoZmluaXNoLCAxMDAwKTtcbn1dKTtcblxuYXBwLmNvbnRyb2xsZXIoJ1NldHVwQ29udHJvbGxlcicsIFsnJHNjb3BlJywgJyRsb2NhdGlvbicsICdDbGllbnQnLCAnV2l6YXJkJywgZnVuY3Rpb24gKCRzY29wZSwgJGxvY2F0aW9uLCBDbGllbnQsIFdpemFyZCkge1xuICAgICRzY29wZS5pbml0aWFsaXplZCA9IGZhbHNlO1xuXG4gICAgLy8gU3R1cGlkIGFuZ3VsYXIgbG9jYXRpb24gcHJvdmlkZXIgZWl0aGVyIHdhbnRzIGh0bWw1IGxvY2F0aW9uIG1vZGUgb3Igbm90LCBkbyB0aGUgcXVlcnkgcGFyc2luZyBvbiBteSBvd25cbiAgICB2YXIgc2VhcmNoID0gZGVjb2RlVVJJQ29tcG9uZW50KHdpbmRvdy5sb2NhdGlvbi5zZWFyY2gpLnNsaWNlKDEpLnNwbGl0KCcmJykubWFwKGZ1bmN0aW9uIChpdGVtKSB7IHJldHVybiBpdGVtLnNwbGl0KCc9Jyk7IH0pLnJlZHVjZShmdW5jdGlvbiAobywgaykgeyBvW2tbMF1dID0ga1sxXTsgcmV0dXJuIG87IH0sIHt9KTtcblxuICAgICRzY29wZS5zZXR1cFRva2VuID0gc2VhcmNoLnNldHVwVG9rZW47XG4gICAgV2l6YXJkLmVtYWlsID0gc2VhcmNoLmVtYWlsO1xuXG4gICAgQ2xpZW50LmlzU2VydmVyRmlyc3RUaW1lKGZ1bmN0aW9uIChlcnJvciwgaXNGaXJzdFRpbWUpIHtcbiAgICAgICAgaWYgKGVycm9yKSB7XG4gICAgICAgICAgICB3aW5kb3cubG9jYXRpb24uaHJlZiA9ICcvZXJyb3IuaHRtbCc7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoIWlzRmlyc3RUaW1lKSB7XG4gICAgICAgICAgICB3aW5kb3cubG9jYXRpb24uaHJlZiA9ICcvJztcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICghV2l6YXJkLnVzZXJuYW1lKSAkbG9jYXRpb24ucGF0aCgnL3N0ZXAxJyk7XG5cbiAgICAgICAgJHNjb3BlLmluaXRpYWxpemVkID0gdHJ1ZTtcblxuICAgIH0pO1xufV0pO1xuIiwiJ3VzZSBzdHJpY3QnO1xuXG4vKiBnbG9iYWwgYW5ndWxhciAqL1xuLyogZ2xvYmFsIEV2ZW50U291cmNlICovXG5cbmFuZ3VsYXIubW9kdWxlKCdBcHBsaWNhdGlvbicpLnNlcnZpY2UoJ0NsaWVudCcsIFsnJGh0dHAnLCAnbWQ1JywgZnVuY3Rpb24gKCRodHRwLCBtZDUpIHtcbiAgICB2YXIgY2xpZW50ID0gbnVsbDtcblxuICAgIGZ1bmN0aW9uIENsaWVudEVycm9yKHN0YXR1c0NvZGUsIG1lc3NhZ2UpIHtcbiAgICAgICAgRXJyb3IuY2FsbCh0aGlzKTtcbiAgICAgICAgdGhpcy5uYW1lID0gdGhpcy5jb25zdHJ1Y3Rvci5uYW1lO1xuICAgICAgICB0aGlzLnN0YXR1c0NvZGUgPSBzdGF0dXNDb2RlO1xuICAgICAgICBpZiAodHlwZW9mIG1lc3NhZ2UgPT0gJ3N0cmluZycpIHtcbiAgICAgICAgICAgIHRoaXMubWVzc2FnZSA9IG1lc3NhZ2U7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLm1lc3NhZ2UgPSBKU09OLnN0cmluZ2lmeShtZXNzYWdlKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGZ1bmN0aW9uIGRlZmF1bHRFcnJvckhhbmRsZXIoY2FsbGJhY2spIHtcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChkYXRhLCBzdGF0dXMpIHtcbiAgICAgICAgICAgIGlmIChzdGF0dXMgPT09IDQwMSkgcmV0dXJuIGNsaWVudC5sb2dvdXQoKTtcbiAgICAgICAgICAgIGNhbGxiYWNrKG5ldyBDbGllbnRFcnJvcihzdGF0dXMsIGRhdGEpKTtcbiAgICAgICAgfTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBDbGllbnQoKSB7XG4gICAgICAgIHRoaXMuX3JlYWR5ID0gZmFsc2U7XG4gICAgICAgIHRoaXMuX2NvbmZpZ0xpc3RlbmVyID0gW107XG4gICAgICAgIHRoaXMuX3JlYWR5TGlzdGVuZXIgPSBbXTtcbiAgICAgICAgdGhpcy5fdXNlckluZm8gPSB7XG4gICAgICAgICAgICB1c2VybmFtZTogbnVsbCxcbiAgICAgICAgICAgIGVtYWlsOiBudWxsLFxuICAgICAgICAgICAgYWRtaW46IGZhbHNlXG4gICAgICAgIH07XG4gICAgICAgIHRoaXMuX3Rva2VuID0gbnVsbDtcbiAgICAgICAgdGhpcy5fY2xpZW50SWQgPSAnY2lkLXdlYmFkbWluJztcbiAgICAgICAgdGhpcy5fY2xpZW50U2VjcmV0ID0gJ3VudXNlZCc7XG4gICAgICAgIHRoaXMuX2NvbmZpZyA9IHtcbiAgICAgICAgICAgIGFwaVNlcnZlck9yaWdpbjogbnVsbCxcbiAgICAgICAgICAgIHdlYlNlcnZlck9yaWdpbjogbnVsbCxcbiAgICAgICAgICAgIGZxZG46IG51bGwsXG4gICAgICAgICAgICBpcDogbnVsbCxcbiAgICAgICAgICAgIHJldmlzaW9uOiBudWxsLFxuICAgICAgICAgICAgdXBkYXRlOiB7IGJveDogbnVsbCwgYXBwczogbnVsbCB9LFxuICAgICAgICAgICAgaXNEZXY6IGZhbHNlLFxuICAgICAgICAgICAgcHJvZ3Jlc3M6IHt9LFxuICAgICAgICAgICAgaXNDdXN0b21Eb21haW46IGZhbHNlXG4gICAgICAgIH07XG4gICAgICAgIHRoaXMuX2luc3RhbGxlZEFwcHMgPSBbXTtcblxuICAgICAgICB0aGlzLnNldFRva2VuKGxvY2FsU3RvcmFnZS50b2tlbik7XG4gICAgfVxuXG4gICAgQ2xpZW50LnByb3RvdHlwZS5zZXRSZWFkeSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKHRoaXMuX3JlYWR5KSByZXR1cm47XG5cbiAgICAgICAgdGhpcy5fcmVhZHkgPSB0cnVlO1xuICAgICAgICB0aGlzLl9yZWFkeUxpc3RlbmVyLmZvckVhY2goZnVuY3Rpb24gKGNhbGxiYWNrKSB7XG4gICAgICAgICAgICBjYWxsYmFjaygpO1xuICAgICAgICB9KTtcbiAgICB9O1xuXG4gICAgQ2xpZW50LnByb3RvdHlwZS5vblJlYWR5ID0gZnVuY3Rpb24gKGNhbGxiYWNrKSB7XG4gICAgICAgIGlmICh0aGlzLl9yZWFkeSkgY2FsbGJhY2soKTtcbiAgICAgICAgdGhpcy5fcmVhZHlMaXN0ZW5lci5wdXNoKGNhbGxiYWNrKTtcbiAgICB9O1xuXG4gICAgQ2xpZW50LnByb3RvdHlwZS5vbkNvbmZpZyA9IGZ1bmN0aW9uIChjYWxsYmFjaykge1xuICAgICAgICB0aGlzLl9jb25maWdMaXN0ZW5lci5wdXNoKGNhbGxiYWNrKTtcbiAgICAgICAgY2FsbGJhY2sodGhpcy5fY29uZmlnKTtcbiAgICB9O1xuXG4gICAgQ2xpZW50LnByb3RvdHlwZS5zZXRVc2VySW5mbyA9IGZ1bmN0aW9uICh1c2VySW5mbykge1xuICAgICAgICAvLyBJbiBvcmRlciB0byBrZWVwIHRoZSBhbmd1bGFyIGJpbmRpbmdzIGFsaXZlLCBzZXQgZWFjaCBwcm9wZXJ0eSBpbmRpdmlkdWFsbHlcbiAgICAgICAgdGhpcy5fdXNlckluZm8udXNlcm5hbWUgPSB1c2VySW5mby51c2VybmFtZTtcbiAgICAgICAgdGhpcy5fdXNlckluZm8uZW1haWwgPSB1c2VySW5mby5lbWFpbDtcbiAgICAgICAgdGhpcy5fdXNlckluZm8uYWRtaW4gPSAhIXVzZXJJbmZvLmFkbWluO1xuICAgICAgICB0aGlzLl91c2VySW5mby5ncmF2YXRhciA9ICdodHRwczovL3d3dy5ncmF2YXRhci5jb20vYXZhdGFyLycgKyBtZDUuY3JlYXRlSGFzaCh1c2VySW5mby5lbWFpbC50b0xvd2VyQ2FzZSgpKSArICcuanBnP3M9MjQmZD1tbSc7XG4gICAgICAgIHRoaXMuX3VzZXJJbmZvLmdyYXZhdGFySHVnZSA9ICdodHRwczovL3d3dy5ncmF2YXRhci5jb20vYXZhdGFyLycgKyBtZDUuY3JlYXRlSGFzaCh1c2VySW5mby5lbWFpbC50b0xvd2VyQ2FzZSgpKSArICcuanBnP3M9MTI4JmQ9bW0nO1xuICAgIH07XG5cbiAgICBDbGllbnQucHJvdG90eXBlLnNldENvbmZpZyA9IGZ1bmN0aW9uIChjb25maWcpIHtcbiAgICAgICAgLy8gSW4gb3JkZXIgdG8ga2VlcCB0aGUgYW5ndWxhciBiaW5kaW5ncyBhbGl2ZSwgc2V0IGVhY2ggcHJvcGVydHkgaW5kaXZpZHVhbGx5IChUT0RPOiBqdXN0IHVzZSBhbmd1bGFyLmNvcHkgPylcbiAgICAgICAgdGhpcy5fY29uZmlnLmFwaVNlcnZlck9yaWdpbiA9IGNvbmZpZy5hcGlTZXJ2ZXJPcmlnaW47XG4gICAgICAgIHRoaXMuX2NvbmZpZy53ZWJTZXJ2ZXJPcmlnaW4gPSBjb25maWcud2ViU2VydmVyT3JpZ2luO1xuICAgICAgICB0aGlzLl9jb25maWcudmVyc2lvbiA9IGNvbmZpZy52ZXJzaW9uO1xuICAgICAgICB0aGlzLl9jb25maWcuZnFkbiA9IGNvbmZpZy5mcWRuO1xuICAgICAgICB0aGlzLl9jb25maWcuaXAgPSBjb25maWcuaXA7XG4gICAgICAgIHRoaXMuX2NvbmZpZy5yZXZpc2lvbiA9IGNvbmZpZy5yZXZpc2lvbjtcbiAgICAgICAgdGhpcy5fY29uZmlnLnVwZGF0ZSA9IGNvbmZpZy51cGRhdGU7XG4gICAgICAgIHRoaXMuX2NvbmZpZy5pc0RldiA9IGNvbmZpZy5pc0RldjtcbiAgICAgICAgdGhpcy5fY29uZmlnLnByb2dyZXNzID0gY29uZmlnLnByb2dyZXNzO1xuICAgICAgICB0aGlzLl9jb25maWcuaXNDdXN0b21Eb21haW4gPSBjb25maWcuaXNDdXN0b21Eb21haW47XG5cbiAgICAgICAgdmFyIHRoYXQgPSB0aGlzO1xuXG4gICAgICAgIHRoaXMuX2NvbmZpZ0xpc3RlbmVyLmZvckVhY2goZnVuY3Rpb24gKGNhbGxiYWNrKSB7XG4gICAgICAgICAgICBjYWxsYmFjayh0aGF0Ll9jb25maWcpO1xuICAgICAgICB9KTtcbiAgICB9O1xuXG4gICAgQ2xpZW50LnByb3RvdHlwZS5nZXRJbnN0YWxsZWRBcHBzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5faW5zdGFsbGVkQXBwcztcbiAgICB9O1xuXG4gICAgQ2xpZW50LnByb3RvdHlwZS5nZXRVc2VySW5mbyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3VzZXJJbmZvO1xuICAgIH07XG5cbiAgICBDbGllbnQucHJvdG90eXBlLmdldENvbmZpZyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2NvbmZpZztcbiAgICB9O1xuXG4gICAgQ2xpZW50LnByb3RvdHlwZS5zZXRUb2tlbiA9IGZ1bmN0aW9uICh0b2tlbikge1xuICAgICAgICAkaHR0cC5kZWZhdWx0cy5oZWFkZXJzLmNvbW1vbi5BdXRob3JpemF0aW9uID0gJ0JlYXJlciAnICsgdG9rZW47XG4gICAgICAgIGlmICghdG9rZW4pIGxvY2FsU3RvcmFnZS5yZW1vdmVJdGVtKCd0b2tlbicpO1xuICAgICAgICBlbHNlIGxvY2FsU3RvcmFnZS50b2tlbiA9IHRva2VuO1xuICAgICAgICB0aGlzLl90b2tlbiA9IHRva2VuO1xuICAgIH07XG5cbiAgICAvKlxuICAgICAqIFJlc3QgQVBJIHdyYXBwZXJzXG4gICAgICovXG4gICAgQ2xpZW50LnByb3RvdHlwZS5jb25maWcgPSBmdW5jdGlvbiAoY2FsbGJhY2spIHtcbiAgICAgICAgJGh0dHAuZ2V0KCcvYXBpL3YxL2Nsb3Vkcm9uL2NvbmZpZycpLnN1Y2Nlc3MoZnVuY3Rpb24oZGF0YSwgc3RhdHVzKSB7XG4gICAgICAgICAgICBpZiAoc3RhdHVzICE9PSAyMDAgfHwgdHlwZW9mIGRhdGEgIT09ICdvYmplY3QnKSByZXR1cm4gY2FsbGJhY2sobmV3IENsaWVudEVycm9yKHN0YXR1cywgZGF0YSkpO1xuICAgICAgICAgICAgY2FsbGJhY2sobnVsbCwgZGF0YSk7XG4gICAgICAgIH0pLmVycm9yKGRlZmF1bHRFcnJvckhhbmRsZXIoY2FsbGJhY2spKTtcbiAgICB9O1xuXG4gICAgQ2xpZW50LnByb3RvdHlwZS51c2VySW5mbyA9IGZ1bmN0aW9uIChjYWxsYmFjaykge1xuICAgICAgICAkaHR0cC5nZXQoJy9hcGkvdjEvcHJvZmlsZScpLnN1Y2Nlc3MoZnVuY3Rpb24oZGF0YSwgc3RhdHVzKSB7XG4gICAgICAgICAgICBpZiAoc3RhdHVzICE9PSAyMDAgfHwgdHlwZW9mIGRhdGEgIT09ICdvYmplY3QnKSByZXR1cm4gY2FsbGJhY2sobmV3IENsaWVudEVycm9yKHN0YXR1cywgZGF0YSkpO1xuICAgICAgICAgICAgY2FsbGJhY2sobnVsbCwgZGF0YSk7XG4gICAgICAgIH0pLmVycm9yKGRlZmF1bHRFcnJvckhhbmRsZXIoY2FsbGJhY2spKTtcbiAgICB9O1xuXG4gICAgQ2xpZW50LnByb3RvdHlwZS5pbnN0YWxsQXBwID0gZnVuY3Rpb24gKGlkLCBtYW5pZmVzdCwgcGFzc3dvcmQsIHRpdGxlLCBjb25maWcsIGNhbGxiYWNrKSB7XG4gICAgICAgIHZhciB0aGF0ID0gdGhpcztcbiAgICAgICAgdmFyIGRhdGEgPSB7IGFwcFN0b3JlSWQ6IGlkLCBtYW5pZmVzdDogbWFuaWZlc3QsIHBhc3N3b3JkOiBwYXNzd29yZCwgbG9jYXRpb246IGNvbmZpZy5sb2NhdGlvbiwgcG9ydEJpbmRpbmdzOiBjb25maWcucG9ydEJpbmRpbmdzLCBhY2Nlc3NSZXN0cmljdGlvbjogY29uZmlnLmFjY2Vzc1Jlc3RyaWN0aW9uIH07XG4gICAgICAgICRodHRwLnBvc3QoJy9hcGkvdjEvYXBwcy9pbnN0YWxsJywgZGF0YSkuc3VjY2VzcyhmdW5jdGlvbiAoZGF0YSwgc3RhdHVzKSB7XG4gICAgICAgICAgICBpZiAoc3RhdHVzICE9PSAyMDIgfHwgdHlwZW9mIGRhdGEgIT09ICdvYmplY3QnKSByZXR1cm4gY2FsbGJhY2sobmV3IENsaWVudEVycm9yKHN0YXR1cywgZGF0YSkpO1xuXG4gICAgICAgICAgICAvLyBwdXQgbmV3IGFwcCB3aXRoIGFtZW5kZWQgdGl0bGUgaW4gY2FjaGVcbiAgICAgICAgICAgIGRhdGEubWFuaWZlc3QgPSB7IHRpdGxlOiB0aXRsZSB9O1xuICAgICAgICAgICAgdGhhdC5faW5zdGFsbGVkQXBwcy5wdXNoKGRhdGEpO1xuXG4gICAgICAgICAgICBjYWxsYmFjayhudWxsLCBkYXRhLmlkKTtcbiAgICAgICAgfSkuZXJyb3IoZGVmYXVsdEVycm9ySGFuZGxlcihjYWxsYmFjaykpO1xuICAgIH07XG5cbiAgICBDbGllbnQucHJvdG90eXBlLnVuaW5zdGFsbEFwcCA9IGZ1bmN0aW9uIChhcHBJZCwgcGFzc3dvcmQsIGNhbGxiYWNrKSB7XG4gICAgICAgIHZhciBkYXRhID0geyBwYXNzd29yZDogcGFzc3dvcmQgfTtcbiAgICAgICAgJGh0dHAucG9zdCgnL2FwaS92MS9hcHBzLycgKyBhcHBJZCArICcvdW5pbnN0YWxsJywgZGF0YSkuc3VjY2VzcyhmdW5jdGlvbiAoZGF0YSwgc3RhdHVzKSB7XG4gICAgICAgICAgICBpZiAoc3RhdHVzICE9PSAyMDIpIHJldHVybiBjYWxsYmFjayhuZXcgQ2xpZW50RXJyb3Ioc3RhdHVzLCBkYXRhKSk7XG4gICAgICAgICAgICBjYWxsYmFjayhudWxsKTtcbiAgICAgICAgfSkuZXJyb3IoZGVmYXVsdEVycm9ySGFuZGxlcihjYWxsYmFjaykpO1xuICAgIH07XG5cbiAgICBDbGllbnQucHJvdG90eXBlLmNvbmZpZ3VyZUFwcCA9IGZ1bmN0aW9uIChpZCwgcGFzc3dvcmQsIGNvbmZpZywgY2FsbGJhY2spIHtcbiAgICAgICAgdmFyIGRhdGEgPSB7IGFwcElkOiBpZCwgcGFzc3dvcmQ6IHBhc3N3b3JkLCBsb2NhdGlvbjogY29uZmlnLmxvY2F0aW9uLCBwb3J0QmluZGluZ3M6IGNvbmZpZy5wb3J0QmluZGluZ3MsIGFjY2Vzc1Jlc3RyaWN0aW9uOiBjb25maWcuYWNjZXNzUmVzdHJpY3Rpb24gfTtcbiAgICAgICAgJGh0dHAucG9zdCgnL2FwaS92MS9hcHBzLycgKyBpZCArICcvY29uZmlndXJlJywgZGF0YSkuc3VjY2VzcyhmdW5jdGlvbiAoZGF0YSwgc3RhdHVzKSB7XG4gICAgICAgICAgICBpZiAoc3RhdHVzICE9PSAyMDIpIHJldHVybiBjYWxsYmFjayhuZXcgQ2xpZW50RXJyb3Ioc3RhdHVzLCBkYXRhKSk7XG4gICAgICAgICAgICBjYWxsYmFjayhudWxsKTtcbiAgICAgICAgfSkuZXJyb3IoZGVmYXVsdEVycm9ySGFuZGxlcihjYWxsYmFjaykpO1xuICAgIH07XG5cbiAgICBDbGllbnQucHJvdG90eXBlLnVwZGF0ZUFwcCA9IGZ1bmN0aW9uIChpZCwgbWFuaWZlc3QsIHBhc3N3b3JkLCBjYWxsYmFjaykge1xuICAgICAgICAkaHR0cC5wb3N0KCcvYXBpL3YxL2FwcHMvJyArIGlkICsgJy91cGRhdGUnLCB7IG1hbmlmZXN0OiBtYW5pZmVzdCwgcGFzc3dvcmQ6IHBhc3N3b3JkIH0pLnN1Y2Nlc3MoZnVuY3Rpb24gKGRhdGEsIHN0YXR1cykge1xuICAgICAgICAgICAgaWYgKHN0YXR1cyAhPT0gMjAyKSByZXR1cm4gY2FsbGJhY2sobmV3IENsaWVudEVycm9yKHN0YXR1cywgZGF0YSkpO1xuICAgICAgICAgICAgY2FsbGJhY2sobnVsbCk7XG4gICAgICAgIH0pLmVycm9yKGRlZmF1bHRFcnJvckhhbmRsZXIoY2FsbGJhY2spKTtcbiAgICB9O1xuXG4gICAgQ2xpZW50LnByb3RvdHlwZS5zdGFydEFwcCA9IGZ1bmN0aW9uIChpZCwgY2FsbGJhY2spIHtcbiAgICAgICAgdmFyIGRhdGEgPSB7IH07XG4gICAgICAgICRodHRwLnBvc3QoJy9hcGkvdjEvYXBwcy8nICsgaWQgKyAnL3N0YXJ0JywgZGF0YSkuc3VjY2VzcyhmdW5jdGlvbiAoZGF0YSwgc3RhdHVzKSB7XG4gICAgICAgICAgICBpZiAoc3RhdHVzICE9PSAyMDIpIHJldHVybiBjYWxsYmFjayhuZXcgQ2xpZW50RXJyb3Ioc3RhdHVzLCBkYXRhKSk7XG4gICAgICAgICAgICBjYWxsYmFjayhudWxsKTtcbiAgICAgICAgfSkuZXJyb3IoZGVmYXVsdEVycm9ySGFuZGxlcihjYWxsYmFjaykpO1xuICAgIH07XG5cbiAgICBDbGllbnQucHJvdG90eXBlLnN0b3BBcHAgPSBmdW5jdGlvbiAoaWQsIGNhbGxiYWNrKSB7XG4gICAgICAgIHZhciBkYXRhID0geyB9O1xuICAgICAgICAkaHR0cC5wb3N0KCcvYXBpL3YxL2FwcHMvJyArIGlkICsgJy9zdG9wJywgZGF0YSkuc3VjY2VzcyhmdW5jdGlvbiAoZGF0YSwgc3RhdHVzKSB7XG4gICAgICAgICAgICBpZiAoc3RhdHVzICE9PSAyMDIpIHJldHVybiBjYWxsYmFjayhuZXcgQ2xpZW50RXJyb3Ioc3RhdHVzLCBkYXRhKSk7XG4gICAgICAgICAgICBjYWxsYmFjayhudWxsKTtcbiAgICAgICAgfSkuZXJyb3IoZGVmYXVsdEVycm9ySGFuZGxlcihjYWxsYmFjaykpO1xuICAgIH07XG5cbiAgICBDbGllbnQucHJvdG90eXBlLnZlcnNpb24gPSBmdW5jdGlvbiAoY2FsbGJhY2spIHtcbiAgICAgICAgJGh0dHAuZ2V0KCcvYXBpL3YxL2Nsb3Vkcm9uL3N0YXR1cycpLnN1Y2Nlc3MoZnVuY3Rpb24oZGF0YSwgc3RhdHVzKSB7XG4gICAgICAgICAgICBpZiAoc3RhdHVzICE9PSAyMDAgfHwgdHlwZW9mIGRhdGEgIT09ICdvYmplY3QnKSByZXR1cm4gY2FsbGJhY2sobmV3IENsaWVudEVycm9yKHN0YXR1cywgZGF0YSkpO1xuICAgICAgICAgICAgY2FsbGJhY2sobnVsbCwgZGF0YSk7XG4gICAgICAgIH0pLmVycm9yKGRlZmF1bHRFcnJvckhhbmRsZXIoY2FsbGJhY2spKTtcbiAgICB9O1xuXG4gICAgQ2xpZW50LnByb3RvdHlwZS5pc1NlcnZlckZpcnN0VGltZSA9IGZ1bmN0aW9uIChjYWxsYmFjaykge1xuICAgICAgICAkaHR0cC5nZXQoJy9hcGkvdjEvY2xvdWRyb24vc3RhdHVzJykuc3VjY2VzcyhmdW5jdGlvbihkYXRhLCBzdGF0dXMpIHtcbiAgICAgICAgICAgIGlmIChzdGF0dXMgIT09IDIwMCB8fCB0eXBlb2YgZGF0YSAhPT0gJ29iamVjdCcpIHJldHVybiBjYWxsYmFjayhuZXcgQ2xpZW50RXJyb3Ioc3RhdHVzLCBkYXRhKSk7XG4gICAgICAgICAgICBjYWxsYmFjayhudWxsLCAhZGF0YS5hY3RpdmF0ZWQpO1xuICAgICAgICB9KS5lcnJvcihkZWZhdWx0RXJyb3JIYW5kbGVyKGNhbGxiYWNrKSk7XG4gICAgfTtcblxuICAgIENsaWVudC5wcm90b3R5cGUuZ2V0TmFrZWREb21haW4gPSBmdW5jdGlvbiAoY2FsbGJhY2spIHtcbiAgICAgICAgJGh0dHAuZ2V0KCcvYXBpL3YxL3NldHRpbmdzL25ha2VkX2RvbWFpbicpXG4gICAgICAgIC5zdWNjZXNzKGZ1bmN0aW9uIChkYXRhLCBzdGF0dXMpIHtcbiAgICAgICAgICAgIGlmIChzdGF0dXMgIT09IDIwMCB8fCB0eXBlb2YgZGF0YSAhPT0gJ29iamVjdCcpIHJldHVybiBjYWxsYmFjayhuZXcgQ2xpZW50RXJyb3Ioc3RhdHVzLCBkYXRhKSk7XG4gICAgICAgICAgICBjYWxsYmFjayhudWxsLCBkYXRhLmFwcGlkKTtcbiAgICAgICAgfSkuZXJyb3IoZGVmYXVsdEVycm9ySGFuZGxlcihjYWxsYmFjaykpO1xuICAgIH07XG5cbiAgICBDbGllbnQucHJvdG90eXBlLnNldE5ha2VkRG9tYWluID0gZnVuY3Rpb24gKGFwcGlkLCBjYWxsYmFjaykge1xuICAgICAgICAkaHR0cC5wb3N0KCcvYXBpL3YxL3NldHRpbmdzL25ha2VkX2RvbWFpbicsIHsgYXBwaWQ6IGFwcGlkIH0pLnN1Y2Nlc3MoZnVuY3Rpb24gKGRhdGEsIHN0YXR1cykge1xuICAgICAgICAgICAgaWYgKHN0YXR1cyAhPT0gMjA0KSByZXR1cm4gY2FsbGJhY2sobmV3IENsaWVudEVycm9yKHN0YXR1cykpO1xuICAgICAgICAgICAgY2FsbGJhY2sobnVsbCk7XG4gICAgICAgIH0pLmVycm9yKGRlZmF1bHRFcnJvckhhbmRsZXIoY2FsbGJhY2spKTtcbiAgICB9O1xuXG4gICAgQ2xpZW50LnByb3RvdHlwZS5nZXRBcHBzID0gZnVuY3Rpb24gKGNhbGxiYWNrKSB7XG4gICAgICAgICRodHRwLmdldCgnL2FwaS92MS9hcHBzJykuc3VjY2VzcyhmdW5jdGlvbiAoZGF0YSwgc3RhdHVzKSB7XG4gICAgICAgICAgICBpZiAoc3RhdHVzICE9PSAyMDAgfHwgdHlwZW9mIGRhdGEgIT09ICdvYmplY3QnKSByZXR1cm4gY2FsbGJhY2sobmV3IENsaWVudEVycm9yKHN0YXR1cywgZGF0YSkpO1xuICAgICAgICAgICAgY2FsbGJhY2sobnVsbCwgZGF0YS5hcHBzKTtcbiAgICAgICAgfSkuZXJyb3IoZGVmYXVsdEVycm9ySGFuZGxlcihjYWxsYmFjaykpO1xuICAgIH07XG5cbiAgICBDbGllbnQucHJvdG90eXBlLmdldEFwcCA9IGZ1bmN0aW9uIChhcHBJZCwgY2FsbGJhY2spIHtcbiAgICAgICAgdmFyIGFwcEZvdW5kID0gbnVsbDtcbiAgICAgICAgdGhpcy5faW5zdGFsbGVkQXBwcy5zb21lKGZ1bmN0aW9uIChhcHApIHtcbiAgICAgICAgICAgIGlmIChhcHAuaWQgPT09IGFwcElkKSB7XG4gICAgICAgICAgICAgICAgYXBwRm91bmQgPSBhcHA7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG5cbiAgICAgICAgaWYgKGFwcEZvdW5kKSByZXR1cm4gY2FsbGJhY2sobnVsbCwgYXBwRm91bmQpO1xuICAgICAgICBlbHNlIHJldHVybiBjYWxsYmFjayhuZXcgRXJyb3IoJ0FwcCBub3QgZm91bmQnKSk7XG4gICAgfTtcblxuICAgIENsaWVudC5wcm90b3R5cGUuZ2V0QXBwTG9nU3RyZWFtID0gZnVuY3Rpb24gKGFwcElkKSB7XG4gICAgICAgIHZhciBzb3VyY2UgPSBuZXcgRXZlbnRTb3VyY2UoJy9hcGkvdjEvYXBwcy8nICsgYXBwSWQgKyAnL2xvZ3N0cmVhbScpO1xuICAgICAgICByZXR1cm4gc291cmNlO1xuICAgIH07XG5cbiAgICBDbGllbnQucHJvdG90eXBlLmdldEFwcExvZ1VybCA9IGZ1bmN0aW9uIChhcHBJZCkge1xuICAgICAgICByZXR1cm4gJy9hcGkvdjEvYXBwcy8nICsgYXBwSWQgKyAnL2xvZ3M/YWNjZXNzX3Rva2VuPScgKyB0aGlzLl90b2tlbjtcbiAgICB9O1xuXG4gICAgQ2xpZW50LnByb3RvdHlwZS5zZXRBZG1pbiA9IGZ1bmN0aW9uICh1c2VybmFtZSwgYWRtaW4sIGNhbGxiYWNrKSB7XG4gICAgICAgIHZhciBwYXlsb2FkID0ge1xuICAgICAgICAgICAgdXNlcm5hbWU6IHVzZXJuYW1lLFxuICAgICAgICAgICAgYWRtaW46IGFkbWluXG4gICAgICAgIH07XG5cbiAgICAgICAgJGh0dHAucG9zdCgnL2FwaS92MS91c2Vycy8nICsgdXNlcm5hbWUgKyAnL2FkbWluJywgcGF5bG9hZCkuc3VjY2VzcyhmdW5jdGlvbiAoZGF0YSwgc3RhdHVzKSB7XG4gICAgICAgICAgICBpZiAoc3RhdHVzICE9PSAyMDQpIHJldHVybiBjYWxsYmFjayhuZXcgQ2xpZW50RXJyb3Ioc3RhdHVzLCBkYXRhKSk7XG4gICAgICAgICAgICBjYWxsYmFjayhudWxsKTtcbiAgICAgICAgfSkuZXJyb3IoZGVmYXVsdEVycm9ySGFuZGxlcihjYWxsYmFjaykpO1xuICAgIH07XG5cbiAgICBDbGllbnQucHJvdG90eXBlLmNyZWF0ZUFkbWluID0gZnVuY3Rpb24gKHVzZXJuYW1lLCBwYXNzd29yZCwgZW1haWwsIHNldHVwVG9rZW4sIGNhbGxiYWNrKSB7XG4gICAgICAgIHZhciBwYXlsb2FkID0ge1xuICAgICAgICAgICAgdXNlcm5hbWU6IHVzZXJuYW1lLFxuICAgICAgICAgICAgcGFzc3dvcmQ6IHBhc3N3b3JkLFxuICAgICAgICAgICAgZW1haWw6IGVtYWlsXG4gICAgICAgIH07XG5cbiAgICAgICAgdmFyIHRoYXQgPSB0aGlzO1xuXG4gICAgICAgICRodHRwLnBvc3QoJy9hcGkvdjEvY2xvdWRyb24vYWN0aXZhdGU/c2V0dXBUb2tlbj0nICsgc2V0dXBUb2tlbiwgcGF5bG9hZCkuc3VjY2VzcyhmdW5jdGlvbihkYXRhLCBzdGF0dXMpIHtcbiAgICAgICAgICAgIGlmIChzdGF0dXMgIT09IDIwMSB8fCB0eXBlb2YgZGF0YSAhPT0gJ29iamVjdCcpIHJldHVybiBjYWxsYmFjayhuZXcgQ2xpZW50RXJyb3Ioc3RhdHVzLCBkYXRhKSk7XG5cbiAgICAgICAgICAgIHRoYXQuc2V0VG9rZW4oZGF0YS50b2tlbik7XG4gICAgICAgICAgICB0aGF0LnNldFVzZXJJbmZvKHsgdXNlcm5hbWU6IHVzZXJuYW1lLCBlbWFpbDogZW1haWwsIGFkbWluOiB0cnVlIH0pO1xuXG4gICAgICAgICAgICBjYWxsYmFjayhudWxsLCBkYXRhLmFjdGl2YXRlZCk7XG4gICAgICAgIH0pLmVycm9yKGRlZmF1bHRFcnJvckhhbmRsZXIoY2FsbGJhY2spKTtcbiAgICB9O1xuXG4gICAgQ2xpZW50LnByb3RvdHlwZS5saXN0VXNlcnMgPSBmdW5jdGlvbiAoY2FsbGJhY2spIHtcbiAgICAgICAgJGh0dHAuZ2V0KCcvYXBpL3YxL3VzZXJzJykuc3VjY2VzcyhmdW5jdGlvbihkYXRhLCBzdGF0dXMpIHtcbiAgICAgICAgICAgIGlmIChzdGF0dXMgIT09IDIwMCB8fCB0eXBlb2YgZGF0YSAhPT0gJ29iamVjdCcpIHJldHVybiBjYWxsYmFjayhuZXcgQ2xpZW50RXJyb3Ioc3RhdHVzLCBkYXRhKSk7XG4gICAgICAgICAgICBjYWxsYmFjayhudWxsLCBkYXRhKTtcbiAgICAgICAgfSkuZXJyb3IoZGVmYXVsdEVycm9ySGFuZGxlcihjYWxsYmFjaykpO1xuICAgIH07XG5cbiAgICBDbGllbnQucHJvdG90eXBlLmdldE9BdXRoQ2xpZW50cyA9IGZ1bmN0aW9uIChjYWxsYmFjaykge1xuICAgICAgICAkaHR0cC5nZXQoJy9hcGkvdjEvb2F1dGgvY2xpZW50cycpLnN1Y2Nlc3MoZnVuY3Rpb24oZGF0YSwgc3RhdHVzKSB7XG4gICAgICAgICAgICBpZiAoc3RhdHVzICE9PSAyMDAgfHwgdHlwZW9mIGRhdGEgIT09ICdvYmplY3QnKSByZXR1cm4gY2FsbGJhY2sobmV3IENsaWVudEVycm9yKHN0YXR1cywgZGF0YSkpO1xuICAgICAgICAgICAgY2FsbGJhY2sobnVsbCwgZGF0YS5jbGllbnRzKTtcbiAgICAgICAgfSkuZXJyb3IoZGVmYXVsdEVycm9ySGFuZGxlcihjYWxsYmFjaykpO1xuICAgIH07XG5cbiAgICBDbGllbnQucHJvdG90eXBlLmRlbFRva2Vuc0J5Q2xpZW50SWQgPSBmdW5jdGlvbiAoaWQsIGNhbGxiYWNrKSB7XG4gICAgICAgICRodHRwLmRlbGV0ZSgnL2FwaS92MS9vYXV0aC9jbGllbnRzLycgKyBpZCArICcvdG9rZW5zJykuc3VjY2VzcyhmdW5jdGlvbihkYXRhLCBzdGF0dXMpIHtcbiAgICAgICAgICAgIGlmIChzdGF0dXMgIT09IDIwNCkgcmV0dXJuIGNhbGxiYWNrKG5ldyBDbGllbnRFcnJvcihzdGF0dXMsIGRhdGEpKTtcbiAgICAgICAgICAgIGNhbGxiYWNrKG51bGwpO1xuICAgICAgICB9KS5lcnJvcihkZWZhdWx0RXJyb3JIYW5kbGVyKGNhbGxiYWNrKSk7XG4gICAgfTtcblxuICAgIENsaWVudC5wcm90b3R5cGUudXBkYXRlID0gZnVuY3Rpb24gKHBhc3N3b3JkLCBjYWxsYmFjaykge1xuICAgICAgICAkaHR0cC5wb3N0KCcvYXBpL3YxL2Nsb3Vkcm9uL3VwZGF0ZScsIHsgcGFzc3dvcmQ6IHBhc3N3b3JkIH0pLnN1Y2Nlc3MoZnVuY3Rpb24oZGF0YSwgc3RhdHVzKSB7XG4gICAgICAgICAgICBpZiAoc3RhdHVzICE9PSAyMDIgfHwgdHlwZW9mIGRhdGEgIT09ICdvYmplY3QnKSByZXR1cm4gY2FsbGJhY2sobmV3IENsaWVudEVycm9yKHN0YXR1cywgZGF0YSkpO1xuICAgICAgICAgICAgY2FsbGJhY2sobnVsbCwgZGF0YSk7XG4gICAgICAgIH0pLmVycm9yKGRlZmF1bHRFcnJvckhhbmRsZXIoY2FsbGJhY2spKTtcbiAgICB9O1xuXG4gICAgQ2xpZW50LnByb3RvdHlwZS5yZWJvb3QgPSBmdW5jdGlvbiAoY2FsbGJhY2spIHtcbiAgICAgICAgJGh0dHAuZ2V0KCcvYXBpL3YxL2Nsb3Vkcm9uL3JlYm9vdCcpLnN1Y2Nlc3MoZnVuY3Rpb24oZGF0YSwgc3RhdHVzKSB7XG4gICAgICAgICAgICBpZiAoc3RhdHVzICE9PSAyMDIgfHwgdHlwZW9mIGRhdGEgIT09ICdvYmplY3QnKSByZXR1cm4gY2FsbGJhY2sobmV3IENsaWVudEVycm9yKHN0YXR1cywgZGF0YSkpO1xuICAgICAgICAgICAgY2FsbGJhY2sobnVsbCwgZGF0YSk7XG4gICAgICAgIH0pLmVycm9yKGRlZmF1bHRFcnJvckhhbmRsZXIoY2FsbGJhY2spKTtcbiAgICB9O1xuXG4gICAgQ2xpZW50LnByb3RvdHlwZS5iYWNrdXAgPSBmdW5jdGlvbiAoY2FsbGJhY2spIHtcbiAgICAgICAgJGh0dHAucG9zdCgnL2FwaS92MS9jbG91ZHJvbi9iYWNrdXBzJykuc3VjY2VzcyhmdW5jdGlvbihkYXRhLCBzdGF0dXMpIHtcbiAgICAgICAgICAgIGlmIChzdGF0dXMgIT09IDIwMiB8fCB0eXBlb2YgZGF0YSAhPT0gJ29iamVjdCcpIHJldHVybiBjYWxsYmFjayhuZXcgQ2xpZW50RXJyb3Ioc3RhdHVzLCBkYXRhKSk7XG4gICAgICAgICAgICBjYWxsYmFjayhudWxsLCBkYXRhKTtcbiAgICAgICAgfSkuZXJyb3IoZGVmYXVsdEVycm9ySGFuZGxlcihjYWxsYmFjaykpO1xuICAgIH07XG5cbiAgICBDbGllbnQucHJvdG90eXBlLnNldENlcnRpZmljYXRlID0gZnVuY3Rpb24gKGNlcnRpZmljYXRlRmlsZSwga2V5RmlsZSwgY2FsbGJhY2spIHtcbiAgICAgICAgY29uc29sZS5sb2coJ3dpbGwgc2V0IGNlcnRpZmljYXRlJyk7XG5cbiAgICAgICAgdmFyIGZkID0gbmV3IEZvcm1EYXRhKCk7XG4gICAgICAgIGZkLmFwcGVuZCgnY2VydGlmaWNhdGUnLCBjZXJ0aWZpY2F0ZUZpbGUpO1xuICAgICAgICBmZC5hcHBlbmQoJ2tleScsIGtleUZpbGUpO1xuXG4gICAgICAgICRodHRwLnBvc3QoJy9hcGkvdjEvY2xvdWRyb24vY2VydGlmaWNhdGUnLCBmZCwge1xuICAgICAgICAgICAgaGVhZGVyczogeyAnQ29udGVudC1UeXBlJzogdW5kZWZpbmVkIH0sXG4gICAgICAgICAgICB0cmFuc2Zvcm1SZXF1ZXN0OiBhbmd1bGFyLmlkZW50aXR5XG4gICAgICAgIH0pLnN1Y2Nlc3MoZnVuY3Rpb24oZGF0YSwgc3RhdHVzKSB7XG4gICAgICAgICAgICBpZiAoc3RhdHVzICE9PSAyMDIpIHJldHVybiBjYWxsYmFjayhuZXcgQ2xpZW50RXJyb3Ioc3RhdHVzLCBkYXRhKSk7XG4gICAgICAgICAgICBjYWxsYmFjayhudWxsKTtcbiAgICAgICAgfSkuZXJyb3IoZGVmYXVsdEVycm9ySGFuZGxlcihjYWxsYmFjaykpO1xuICAgIH07XG5cbiAgICBDbGllbnQucHJvdG90eXBlLmdyYXBocyA9IGZ1bmN0aW9uICh0YXJnZXRzLCBmcm9tLCBjYWxsYmFjaykge1xuICAgICAgICB2YXIgY29uZmlnID0ge1xuICAgICAgICAgICAgcGFyYW1zOiB7XG4gICAgICAgICAgICAgICAgdGFyZ2V0OiB0YXJnZXRzLFxuICAgICAgICAgICAgICAgIGZvcm1hdDogJ2pzb24nLFxuICAgICAgICAgICAgICAgIGZyb206IGZyb21cbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcblxuICAgICAgICAkaHR0cC5nZXQoJy9hcGkvdjEvY2xvdWRyb24vZ3JhcGhzJywgY29uZmlnKS5zdWNjZXNzKGZ1bmN0aW9uIChkYXRhLCBzdGF0dXMpIHtcbiAgICAgICAgICAgIGlmIChzdGF0dXMgIT09IDIwMCB8fCB0eXBlb2YgZGF0YSAhPT0gJ29iamVjdCcpIHJldHVybiBjYWxsYmFjayhuZXcgQ2xpZW50RXJyb3Ioc3RhdHVzLCBkYXRhKSk7XG4gICAgICAgICAgICBjYWxsYmFjayhudWxsLCBkYXRhKTtcbiAgICAgICAgfSkuZXJyb3IoZGVmYXVsdEVycm9ySGFuZGxlcihjYWxsYmFjaykpO1xuICAgIH07XG5cbiAgICBDbGllbnQucHJvdG90eXBlLmNyZWF0ZVVzZXIgPSBmdW5jdGlvbiAodXNlcm5hbWUsIGVtYWlsLCBjYWxsYmFjaykge1xuICAgICAgICB2YXIgZGF0YSA9IHtcbiAgICAgICAgICAgIHVzZXJuYW1lOiB1c2VybmFtZSxcbiAgICAgICAgICAgIGVtYWlsOiBlbWFpbFxuICAgICAgICB9O1xuXG4gICAgICAgICRodHRwLnBvc3QoJy9hcGkvdjEvdXNlcnMnLCBkYXRhKS5zdWNjZXNzKGZ1bmN0aW9uKGRhdGEsIHN0YXR1cykge1xuICAgICAgICAgICAgaWYgKHN0YXR1cyAhPT0gMjAxIHx8IHR5cGVvZiBkYXRhICE9PSAnb2JqZWN0JykgcmV0dXJuIGNhbGxiYWNrKG5ldyBDbGllbnRFcnJvcihzdGF0dXMsIGRhdGEpKTtcbiAgICAgICAgICAgIGNhbGxiYWNrKG51bGwsIGRhdGEpO1xuICAgICAgICB9KS5lcnJvcihkZWZhdWx0RXJyb3JIYW5kbGVyKGNhbGxiYWNrKSk7XG4gICAgfTtcblxuICAgIENsaWVudC5wcm90b3R5cGUucmVtb3ZlVXNlciA9IGZ1bmN0aW9uICh1c2VybmFtZSwgcGFzc3dvcmQsIGNhbGxiYWNrKSB7XG4gICAgICAgIHZhciBkYXRhID0ge1xuICAgICAgICAgICAgdXNlcm5hbWU6IHVzZXJuYW1lLFxuICAgICAgICAgICAgcGFzc3dvcmQ6IHBhc3N3b3JkXG4gICAgICAgIH07XG5cbiAgICAgICAgJGh0dHAoeyBtZXRob2Q6ICdERUxFVEUnLCB1cmw6ICcvYXBpL3YxL3VzZXJzLycgKyB1c2VybmFtZSwgZGF0YTogZGF0YSwgaGVhZGVyczogeyAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nIH19KS5zdWNjZXNzKGZ1bmN0aW9uKGRhdGEsIHN0YXR1cykge1xuICAgICAgICAgICAgaWYgKHN0YXR1cyAhPT0gMjA0KSByZXR1cm4gY2FsbGJhY2sobmV3IENsaWVudEVycm9yKHN0YXR1cywgZGF0YSkpO1xuICAgICAgICAgICAgY2FsbGJhY2sobnVsbCk7XG4gICAgICAgIH0pLmVycm9yKGRlZmF1bHRFcnJvckhhbmRsZXIoY2FsbGJhY2spKTtcbiAgICB9O1xuXG4gICAgQ2xpZW50LnByb3RvdHlwZS5jaGFuZ2VQYXNzd29yZCA9IGZ1bmN0aW9uIChjdXJyZW50UGFzc3dvcmQsIG5ld1Bhc3N3b3JkLCBjYWxsYmFjaykge1xuICAgICAgICB2YXIgZGF0YSA9IHtcbiAgICAgICAgICAgIHBhc3N3b3JkOiBjdXJyZW50UGFzc3dvcmQsXG4gICAgICAgICAgICBuZXdQYXNzd29yZDogbmV3UGFzc3dvcmRcbiAgICAgICAgfTtcblxuICAgICAgICAkaHR0cC5wb3N0KCcvYXBpL3YxL3VzZXJzLycgKyB0aGlzLl91c2VySW5mby51c2VybmFtZSArICcvcGFzc3dvcmQnLCBkYXRhKS5zdWNjZXNzKGZ1bmN0aW9uKGRhdGEsIHN0YXR1cykge1xuICAgICAgICAgICAgaWYgKHN0YXR1cyAhPT0gMjA0KSByZXR1cm4gY2FsbGJhY2sobmV3IENsaWVudEVycm9yKHN0YXR1cywgZGF0YSkpO1xuICAgICAgICAgICAgY2FsbGJhY2sobnVsbCwgZGF0YSk7XG4gICAgICAgIH0pLmVycm9yKGRlZmF1bHRFcnJvckhhbmRsZXIoY2FsbGJhY2spKTtcbiAgICB9O1xuXG4gICAgQ2xpZW50LnByb3RvdHlwZS5jaGFuZ2VFbWFpbCA9IGZ1bmN0aW9uIChlbWFpbCwgcGFzc3dvcmQsIGNhbGxiYWNrKSB7XG4gICAgICAgIHZhciBkYXRhID0ge1xuICAgICAgICAgICAgcGFzc3dvcmQ6IHBhc3N3b3JkLFxuICAgICAgICAgICAgZW1haWw6IGVtYWlsXG4gICAgICAgIH07XG5cbiAgICAgICAgJGh0dHAucHV0KCcvYXBpL3YxL3VzZXJzLycgKyB0aGlzLl91c2VySW5mby51c2VybmFtZSwgZGF0YSkuc3VjY2VzcyhmdW5jdGlvbihkYXRhLCBzdGF0dXMpIHtcbiAgICAgICAgICAgIGlmIChzdGF0dXMgIT09IDIwNCkgcmV0dXJuIGNhbGxiYWNrKG5ldyBDbGllbnRFcnJvcihzdGF0dXMsIGRhdGEpKTtcbiAgICAgICAgICAgIGNhbGxiYWNrKG51bGwsIGRhdGEpO1xuICAgICAgICB9KS5lcnJvcihkZWZhdWx0RXJyb3JIYW5kbGVyKGNhbGxiYWNrKSk7XG4gICAgfTtcblxuICAgIENsaWVudC5wcm90b3R5cGUucmVmcmVzaENvbmZpZyA9IGZ1bmN0aW9uIChjYWxsYmFjaykge1xuICAgICAgICB2YXIgdGhhdCA9IHRoaXM7XG5cbiAgICAgICAgY2FsbGJhY2sgPSB0eXBlb2YgY2FsbGJhY2sgPT09ICdmdW5jdGlvbicgPyBjYWxsYmFjayA6IGZ1bmN0aW9uICgpIHt9O1xuXG4gICAgICAgIHRoaXMuY29uZmlnKGZ1bmN0aW9uIChlcnJvciwgcmVzdWx0KSB7XG4gICAgICAgICAgICBpZiAoZXJyb3IpIHJldHVybiBjYWxsYmFjayhlcnJvcik7XG5cbiAgICAgICAgICAgIHRoYXQuc2V0Q29uZmlnKHJlc3VsdCk7XG4gICAgICAgICAgICBjYWxsYmFjayhudWxsKTtcbiAgICAgICAgfSk7XG4gICAgfTtcblxuICAgIENsaWVudC5wcm90b3R5cGUucmVmcmVzaEluc3RhbGxlZEFwcHMgPSBmdW5jdGlvbiAoY2FsbGJhY2spIHtcbiAgICAgICAgdmFyIHRoYXQgPSB0aGlzO1xuXG4gICAgICAgIGNhbGxiYWNrID0gdHlwZW9mIGNhbGxiYWNrID09PSAnZnVuY3Rpb24nID8gY2FsbGJhY2sgOiBmdW5jdGlvbiAoKSB7fTtcblxuICAgICAgICB0aGlzLmdldEFwcHMoZnVuY3Rpb24gKGVycm9yLCBhcHBzKSB7XG4gICAgICAgICAgICBpZiAoZXJyb3IpIHJldHVybiBjYWxsYmFjayhlcnJvcik7XG5cbiAgICAgICAgICAgIC8vIGluc2VydCBvciB1cGRhdGUgbmV3IGFwcHNcbiAgICAgICAgICAgIGFwcHMuZm9yRWFjaChmdW5jdGlvbiAoYXBwKSB7XG4gICAgICAgICAgICAgICAgdmFyIGZvdW5kID0gZmFsc2U7XG5cbiAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoYXQuX2luc3RhbGxlZEFwcHMubGVuZ3RoOyArK2kpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoYXQuX2luc3RhbGxlZEFwcHNbaV0uaWQgPT09IGFwcC5pZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgZm91bmQgPSBpO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBpZiAoZm91bmQgIT09IGZhbHNlKSB7XG4gICAgICAgICAgICAgICAgICAgIGFuZ3VsYXIuY29weShhcHAsIHRoYXQuX2luc3RhbGxlZEFwcHNbZm91bmRdKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB0aGF0Ll9pbnN0YWxsZWRBcHBzLnB1c2goYXBwKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgLy8gZmlsdGVyIG91dCBvbGQgZW50cmllcywgZ29pbmcgYmFja3dhcmRzIHRvIGFsbG93IHNwbGljaW5nXG4gICAgICAgICAgICBmb3IodmFyIGkgPSB0aGF0Ll9pbnN0YWxsZWRBcHBzLmxlbmd0aCAtIDE7IGkgPj0gMDsgLS1pKSB7XG4gICAgICAgICAgICAgICAgaWYgKCFhcHBzLnNvbWUoZnVuY3Rpb24gKGVsZW0pIHsgcmV0dXJuIChlbGVtLmlkID09PSB0aGF0Ll9pbnN0YWxsZWRBcHBzW2ldLmlkKTsgfSkpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhhdC5faW5zdGFsbGVkQXBwcy5zcGxpY2UoaSwgMSk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGNhbGxiYWNrKG51bGwpO1xuICAgICAgICB9KTtcbiAgICB9O1xuXG4gICAgQ2xpZW50LnByb3RvdHlwZS5sb2dvdXQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuc2V0VG9rZW4obnVsbCk7XG4gICAgICAgIHRoaXMuX3VzZXJJbmZvID0ge307XG5cbiAgICAgICAgLy8gbG9nb3V0IGZyb20gT0F1dGggc2Vzc2lvblxuICAgICAgICB3aW5kb3cubG9jYXRpb24uaHJlZiA9ICcvYXBpL3YxL3Nlc3Npb24vbG9nb3V0JztcbiAgICB9O1xuXG4gICAgQ2xpZW50LnByb3RvdHlwZS5leGNoYW5nZUNvZGVGb3JUb2tlbiA9IGZ1bmN0aW9uIChhdXRoQ29kZSwgY2FsbGJhY2spIHtcbiAgICAgICAgdmFyIGRhdGEgPSB7XG4gICAgICAgICAgICBncmFudF90eXBlOiAnYXV0aG9yaXphdGlvbl9jb2RlJyxcbiAgICAgICAgICAgIGNvZGU6IGF1dGhDb2RlLFxuICAgICAgICAgICAgcmVkaXJlY3RfdXJpOiB3aW5kb3cubG9jYXRpb24ub3JpZ2luLFxuICAgICAgICAgICAgY2xpZW50X2lkOiB0aGlzLl9jbGllbnRJZCxcbiAgICAgICAgICAgIGNsaWVudF9zZWNyZXQ6IHRoaXMuX2NsaWVudFNlY3JldFxuICAgICAgICB9O1xuXG4gICAgICAgICRodHRwLnBvc3QoJy9hcGkvdjEvb2F1dGgvdG9rZW4/cmVzcG9uc2VfdHlwZT10b2tlbiZjbGllbnRfaWQ9JyArIHRoaXMuX2NsaWVudElkLCBkYXRhKS5zdWNjZXNzKGZ1bmN0aW9uKGRhdGEsIHN0YXR1cykge1xuICAgICAgICAgICAgaWYgKHN0YXR1cyAhPT0gMjAwIHx8IHR5cGVvZiBkYXRhICE9PSAnb2JqZWN0JykgcmV0dXJuIGNhbGxiYWNrKG5ldyBDbGllbnRFcnJvcihzdGF0dXMsIGRhdGEpKTtcblxuICAgICAgICAgICAgY2FsbGJhY2sobnVsbCwgZGF0YS5hY2Nlc3NfdG9rZW4pO1xuICAgICAgICB9KS5lcnJvcihkZWZhdWx0RXJyb3JIYW5kbGVyKGNhbGxiYWNrKSk7XG4gICAgfTtcblxuICAgIGNsaWVudCA9IG5ldyBDbGllbnQoKTtcbiAgICByZXR1cm4gY2xpZW50O1xufV0pO1xuIl0sInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9